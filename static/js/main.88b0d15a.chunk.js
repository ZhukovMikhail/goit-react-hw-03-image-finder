(this["webpackJsonpgoit-react-hw-03-phonebook"]=this["webpackJsonpgoit-react-hw-03-phonebook"]||[]).push([[0],{15:function(t,e,a){},16:function(t,e,a){},39:function(t,e,a){"use strict";a.r(e);var o=a(0),n=a.n(o),r=a(7),s=a.n(r),c=(a(15),a(3)),i=a(4),l=a(6),u=a(5),h=(a(16),a(8)),p=(a(17),a(1)),g=function(t){Object(l.a)(a,t);var e=Object(u.a)(a);function a(){var t;Object(c.a)(this,a);for(var o=arguments.length,n=new Array(o),r=0;r<o;r++)n[r]=arguments[r];return(t=e.call.apply(e,[this].concat(n))).state={searchQuerry:""},t.onSearchFormChange=function(e){t.setState({searchQuerry:e.currentTarget.value})},t.onSubmitForm=function(e){e.preventDefault(),""!==t.state.searchQuerry.trim()?(t.props.onSubmit(t.state.searchQuerry),t.setState({searchQuerry:""})):h.b.warn("No data entered")},t}return Object(i.a)(a,[{key:"render",value:function(){return Object(p.jsx)("header",{className:"Searchbar",children:Object(p.jsxs)("form",{className:"SearchForm",onSubmit:this.onSubmitForm,children:[Object(p.jsx)("button",{type:"submit",className:"SearchForm-button",children:Object(p.jsx)("span",{className:"SearchForm-button-label",children:"Search"})}),Object(p.jsx)("input",{className:"SearchForm-input",type:"text",autoComplete:"off",autoFocus:!0,placeholder:"Search images and photos",onChange:this.onSearchFormChange,value:this.state.searchQuerry})]})})}}]),a}(o.Component),d=g,b=function(t){Object(l.a)(a,t);var e=Object(u.a)(a);function a(){var t;Object(c.a)(this,a);for(var o=arguments.length,n=new Array(o),r=0;r<o;r++)n[r]=arguments[r];return(t=e.call.apply(e,[this].concat(n))).state={querry:[],perPage:12,pageNumber:1,totalHits:null,loading:!1,error:!1},t}return Object(i.a)(a,[{key:"componentDidUpdate",value:function(t,e){var a=this;if(this.props.page!==this.state.pageNumber){if(1===this.props.page)return void this.setState({perPage:12,pageNumber:1});this.setState((function(t){return{perPage:t.perPage+12,pageNumber:t.pageNumber+1}}))}if(t.querry!==this.props.querry||e.pageNumber!==this.props.page){this.setState({loading:!0}),this.props.loading(this.state.loading),console.log("change querry"),console.log("Prev querry",t.querry),console.log("text of querry",this.props.querry);fetch("https://pixabay.com/api/?q=".concat(this.props.querry,"&page=").concat(this.state.pageNumber,"&key=").concat("22985243-b477986a48324befacd1d8a65","&image_type=photo&orientation=horizontal&per_page=").concat(this.state.perPage)).then((function(t){return t.json()})).then((function(t){a.setState({querry:t.hits,totalHits:t.totalHits}),console.log(t),console.log(a.state.totalHits),a.props.totalHits(a.state.totalHits)})).catch((function(t){console.log(t),a.setState({querry:[],totalHits:null,error:!0})})).finally((function(){a.setState({loading:!1}),a.props.loading(a.state.loading)}))}window.scrollTo({top:document.documentElement.scrollHeight,behavior:"smooth"})}},{key:"render",value:function(){var t=this;return 0!==this.state.totalHits?this.state.querry.map((function(e){return Object(p.jsx)("li",{className:"ImageGalleryItem",children:Object(p.jsx)("img",{onClick:t.props.onClick,src:e.webformatURL,"data-src":e.largeImageURL,alt:e.tags,className:"ImageGalleryItem-image"})},e.id)})):Object(p.jsx)("h2",{className:"title",children:" No match found"})}}]),a}(o.Component),m=function(t){Object(l.a)(a,t);var e=Object(u.a)(a);function a(){return Object(c.a)(this,a),e.apply(this,arguments)}return Object(i.a)(a,[{key:"render",value:function(){return Object(p.jsx)("ul",{className:"ImageGallery",children:Object(p.jsx)(b,{querry:this.props.querry,page:this.props.page,totalHits:this.props.totalHits,onClick:this.props.onClick,loading:this.props.loading})})}}]),a}(o.Component),j=document.querySelector("#modal-root"),y=function(t){Object(l.a)(a,t);var e=Object(u.a)(a);function a(){var t;Object(c.a)(this,a);for(var o=arguments.length,n=new Array(o),r=0;r<o;r++)n[r]=arguments[r];return(t=e.call.apply(e,[this].concat(n))).idEscapeEvent=function(e){"Escape"===e.code&&t.props.onToggleModal()},t.onBackdropClick=function(e){e.currentTarget===e.target&&t.props.onToggleModal()},t}return Object(i.a)(a,[{key:"componentDidMount",value:function(){console.log("Modal componentDidMount"),window.addEventListener("keydown",this.idEscapeEvent)}},{key:"componentWillUnmount",value:function(){window.removeEventListener("keydown",this.idEscapeEvent)}},{key:"render",value:function(){return Object(r.createPortal)(Object(p.jsx)("div",{className:"Overlay",onClick:this.onBackdropClick,children:Object(p.jsx)("div",{className:"Modal",children:this.props.children})}),j)}}]),a}(o.Component),f=function(t){Object(l.a)(a,t);var e=Object(u.a)(a);function a(){return Object(c.a)(this,a),e.apply(this,arguments)}return Object(i.a)(a,[{key:"render",value:function(){return Object(p.jsx)("button",{className:"Button",onClick:this.props.onLoadMore,children:"Load more"})}}]),a}(o.Component),O=a(10),v=a.n(O),S=function(t){Object(l.a)(a,t);var e=Object(u.a)(a);function a(){var t;Object(c.a)(this,a);for(var o=arguments.length,n=new Array(o),r=0;r<o;r++)n[r]=arguments[r];return(t=e.call.apply(e,[this].concat(n))).state={querry:"",showModal:!1,largeImg:null,totalHits:null,page:1,loading:!1},t.toggleModal=function(){t.setState((function(t){return{showModal:!t.showModal}}))},t.onImageClick=function(e){(e.target="IMG")&&t.toggleModal(),console.dir(e.currentTarget.dataset.src),t.setState({largeImg:e.currentTarget.dataset.src})},t.onSearchSubmit=function(e){console.log(e),t.setState({querry:e,page:1})},t.totalHits=function(e){0===e?t.setState({totalHits:null}):t.setState({totalHits:e})},t.onLoadMore=function(){console.log("\u043a\u043b\u0438\u043a\u043d\u0443\u043b\u0438 \u043d\u0430 onLoadMore"),t.setState((function(t){return{page:t.page+1}}))},t.onLoading=function(){t.setState({loading:!t.state.loading})},t}return Object(i.a)(a,[{key:"render",value:function(){return Object(p.jsxs)("div",{className:"section",children:[Object(p.jsx)(d,{onSubmit:this.onSearchSubmit}),this.state.loading&&Object(p.jsx)(v.a,{type:"Bars",className:"spinner",color:"#00BFFF",height:50,width:50}),Object(p.jsx)(m,{querry:this.state.querry,page:this.state.page,totalHits:this.totalHits,onClick:this.onImageClick,loading:this.onLoading}),this.state.totalHits&&Object(p.jsx)(f,{onLoadMore:this.onLoadMore}),this.state.showModal&&Object(p.jsxs)(y,{onToggleModal:this.toggleModal,children:[Object(p.jsx)("img",{src:this.state.largeImg,alt:this.state.querry}),Object(p.jsx)("button",{className:"closeBtn",type:"button",onClick:this.toggleModal,children:"X"})]}),Object(p.jsx)(h.a,{position:"top-center",autoClose:1e3})]})}}]),a}(o.Component),k=S;s.a.render(Object(p.jsx)(n.a.StrictMode,{children:Object(p.jsx)(k,{})}),document.getElementById("root"))}},[[39,1,2]]]);
//# sourceMappingURL=main.88b0d15a.chunk.js.map